<h2>Pokémons</h2>
<dx-button
    *ngIf="!hasImported && !loading"
    text="Importar Pokémons"
    type="success"    
    [disabled]="loading"
    (onClick)="importarPokemons()"
></dx-button>

<dx-data-grid
    *ngIf="hasImported && !loading"
    [dataSource]="pokemons"
    [showBorders]="true"
>
    <dxi-column
      caption="Imagem"
      width="150"
      alignment="center"
      cellTemplate="imageTemplate">
    </dxi-column>

    <div *dxTemplate="let data of 'imageTemplate'">
      <div class="pokemon-image-cell">

        <!-- SE TEM IMAGEM -->
        <ng-container *ngIf="data.data.imageUrl; else noImage">
          <img
            [src]="data.data.imageUrl"
            class="pokemon-image"
            alt="Pokémon"
          />

          <dx-button
            icon="edit"
            stylingMode="text"
            hint="Alterar imagem"
            (onClick)="onChangeImageClick(data)">
          </dx-button>

          <dx-button
            icon="trash"
            stylingMode="text"
            hint="Remover imagem"
            (onClick)="onRemoveImageClick(data)">
          </dx-button>
        </ng-container>

        <!-- SE NÃO TEM IMAGEM -->
        <ng-template #noImage>
          <dx-button
            icon="image"
            text="Adicionar"
            stylingMode="text"
            (onClick)="onAddImageClick(data)">
          </dx-button>
        </ng-template>

      </div>
    </div>

    <dxi-column dataField="name" caption="Nome" width="300"></dxi-column>
    <dxi-column dataField="level" caption="Nível" width="80"></dxi-column>

    <dxi-column
        name="upLevel"
        caption="Aumentar nível"
        type="buttons"
        width="120">
        <dxi-button [template]="'upLevelTemplate'"></dxi-button>
    </dxi-column>

    <div *dxTemplate="let data of 'upLevelTemplate'">
      <dx-button
        icon="add"
        hint="Aumentar nível do pokémon"
        stylingMode="text"
        (onClick)="onUpLevelClick(data)">
      </dx-button>
    </div>

    <dxi-column name="favorite" caption="Favorito" type="buttons">
      <dxi-button
        [template]="'favoriteTemplate'">
      </dxi-button>
    </dxi-column>

  <div *dxTemplate="let data of 'favoriteTemplate'">
    <dx-button
      [icon]="data.data.isFavorite ? 'ratingfilled' : 'ratingoutline'"
      [hint]="data.data.isFavorite ? 'Remover' : 'Favoritar'"
      [elementAttr]="{ class: data.data.isFavorite ? 'btn-favorite-on' : 'btn-favorite-off' }"
      stylingMode="text"
      (onClick)="onFavoriteClick(data)">
    </dx-button>
  </div>
</dx-data-grid>

<div *ngIf="loading">
  Carregando...
</div>

<input
  type="file"
  #fileInput
  accept="image/*"
  hidden
  (change)="onFileSelected($event)">
